<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RIFT — Fraud Detection Intelligence Platform</title>
  <meta name="description" content="Real-time Interactive Fraud Tracking — Upload transaction data, detect fraud rings, visualize suspicious patterns, and investigate accounts." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/cytoscape@3.28.1/dist/cytoscape.min.js"></script>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>

  <!-- ═══════════════ PARTICLE CANVAS ═══════════════ -->
  <canvas id="particleCanvas"></canvas>

  <!-- ═══════════════ TOP NAV BAR ═══════════════ -->
  <nav id="navbar">
    <div class="nav-brand">
      <div class="brand-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="url(#grad)" stroke-width="2">
          <defs><linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#06d6a0"/><stop offset="100%" style="stop-color:#00b4d8"/></linearGradient></defs>
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
        </svg>
      </div>
      <span class="brand-name">RIFT</span>
      <span class="brand-tagline">Fraud Intelligence Platform</span>
    </div>
    <div class="nav-controls">
      <!-- Back button (Results view only) -->
      <button class="btn-back hidden" id="backToDashboard">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
        Dashboard
      </button>
      <div class="mode-toggle" id="modeToggle">
        <button class="mode-btn active" data-mode="analyst" id="analystBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12H3M12 3v18M7 8l5-5 5 5M7 16l5 5 5-5"/></svg>
          Analyst
        </button>
        <button class="mode-btn" data-mode="investigator" id="investigatorBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          Investigator
        </button>
      </div>
      <div class="nav-status" id="navStatus">
        <span class="status-dot offline"></span>
        <span>No data loaded</span>
      </div>
    </div>
  </nav>

  <!-- ═══════════════════════════════════════════════════════════ -->
  <!--  VIEW 1: DASHBOARD LANDING PAGE                           -->
  <!-- ═══════════════════════════════════════════════════════════ -->
  <div id="dashboardView" class="view active">

    <!-- ────── HERO SECTION ────── -->
    <section class="hero-section">
      <div class="hero-content">
        <div class="hero-badge animate-on-scroll">
          <span class="badge-dot"></span>
          Real-Time Intelligence Engine
        </div>
        <h1 class="hero-title animate-on-scroll">
          <span class="hero-line">Detect Fraud.</span>
          <span class="hero-line gradient-text">Protect Assets.</span>
          <span class="hero-line">Stay Ahead.</span>
        </h1>
        <p class="hero-description animate-on-scroll">
          RIFT analyzes transaction networks in real-time to uncover hidden fraud rings, 
          smurfing patterns, and shell chains with precision scoring and interactive graph exploration.
        </p>
        <div class="hero-actions animate-on-scroll">
          <a href="#uploadArea" class="btn-hero-primary">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10"/></svg>
            Start Analysis
          </a>
          <a href="#featuresSection" class="btn-hero-secondary">
            Learn More
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </a>
        </div>
        <div class="hero-stats animate-on-scroll">
          <div class="hero-stat">
            <span class="hero-stat-value" data-count="3">3</span>
            <span class="hero-stat-label">Detection Engines</span>
          </div>
          <div class="hero-stat-divider"></div>
          <div class="hero-stat">
            <span class="hero-stat-value" data-count="100">100</span><span class="hero-stat-suffix">%</span>
            <span class="hero-stat-label">Client-Side Privacy</span>
          </div>
          <div class="hero-stat-divider"></div>
          <div class="hero-stat">
            <span class="hero-stat-value">&lt;1</span><span class="hero-stat-suffix">s</span>
            <span class="hero-stat-label">Processing Time</span>
          </div>
        </div>
      </div>
      <div class="hero-visual">
        <div class="hero-orb"></div>
        <div class="hero-orb hero-orb-2"></div>
        <div class="hero-orb hero-orb-3"></div>
      </div>
    </section>

    <!-- ────── FEATURES SECTION ────── -->
    <section id="featuresSection" class="features-section">
      <div class="section-label animate-on-scroll">
        <span class="label-line"></span>
        CAPABILITIES
        <span class="label-line"></span>
      </div>
      <h2 class="section-title animate-on-scroll">Powerful Detection Engines</h2>
      <p class="section-subtitle animate-on-scroll">Four specialized algorithms working in concert to identify even the most sophisticated fraud patterns.</p>

      <div class="features-grid">
        <div class="feature-card animate-on-scroll" data-delay="0">
          <div class="feature-card-glow"></div>
          <div class="feature-icon red-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
          </div>
          <h3>Cycle Detection</h3>
          <p>Bounded DFS algorithm (depth 3–5) with 72-hour time constraints and ≤1.25 amount ratio. Canonical deduplication prevents double-counting.</p>
          <div class="feature-tag">Graph Analysis</div>
        </div>

        <div class="feature-card animate-on-scroll" data-delay="100">
          <div class="feature-card-glow"></div>
          <div class="feature-icon orange-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          </div>
          <h3>Smurfing Detection</h3>
          <p>Fan-out pattern analysis identifying accounts distributing funds to ≥5 recipients with similar amounts within short time windows.</p>
          <div class="feature-tag">Structuring</div>
        </div>

        <div class="feature-card animate-on-scroll" data-delay="200">
          <div class="feature-card-glow"></div>
          <div class="feature-icon purple-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 12h18M12 3v18"/></svg>
          </div>
          <h3>Shell Chain Detection</h3>
          <p>Identifies layered pass-through chains where funds flow through intermediate "shell" accounts with minimal retention.</p>
          <div class="feature-tag">Layering</div>
        </div>

        <div class="feature-card animate-on-scroll" data-delay="300">
          <div class="feature-card-glow"></div>
          <div class="feature-icon green-icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
          </div>
          <h3>Scoring Engine</h3>
          <p>Multi-factor scoring with base pattern weights, interaction bonuses, structural confidence, density adjustment, and normalization.</p>
          <div class="feature-tag">Risk Score</div>
        </div>
      </div>
    </section>

    <!-- ────── HOW IT WORKS ────── -->
    <section class="pipeline-section">
      <div class="section-label animate-on-scroll">
        <span class="label-line"></span>
        WORKFLOW
        <span class="label-line"></span>
      </div>
      <h2 class="section-title animate-on-scroll">How It Works</h2>
      <p class="section-subtitle animate-on-scroll">From raw CSV data to actionable intelligence in seconds.</p>

      <div class="pipeline-steps">
        <div class="pipeline-step-card animate-on-scroll" data-delay="0">
          <div class="step-number">01</div>
          <div class="step-connector"></div>
          <div class="step-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          </div>
          <h4>Upload CSV</h4>
          <p>Drag & drop your transaction data</p>
        </div>
        <div class="pipeline-step-card animate-on-scroll" data-delay="150">
          <div class="step-number">02</div>
          <div class="step-connector"></div>
          <div class="step-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><circle cx="18" cy="18" r="3"/><line x1="9" y1="6" x2="15" y2="6"/><line x1="6" y1="9" x2="6" y2="15"/></svg>
          </div>
          <h4>Build Graph</h4>
          <p>Directed transaction network constructed</p>
        </div>
        <div class="pipeline-step-card animate-on-scroll" data-delay="300">
          <div class="step-number">03</div>
          <div class="step-connector"></div>
          <div class="step-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
          </div>
          <h4>Detect Patterns</h4>
          <p>Cycles, smurfing & shell chains found</p>
        </div>
        <div class="pipeline-step-card animate-on-scroll" data-delay="450">
          <div class="step-number">04</div>
          <div class="step-icon final-step">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
          </div>
          <h4>Get Results</h4>
          <p>Interactive dashboard with risk scores</p>
        </div>
      </div>
    </section>

    <!-- ────── UPLOAD SECTION ────── -->
    <section id="uploadArea" class="upload-section">
      <div class="section-label animate-on-scroll">
        <span class="label-line"></span>
        ANALYZE
        <span class="label-line"></span>
      </div>
      <h2 class="section-title animate-on-scroll">Start Your Analysis</h2>
      <p class="section-subtitle animate-on-scroll">Upload a transaction CSV file to run the full fraud detection pipeline.</p>

      <div class="upload-container">
        <div id="dropZone" class="drop-zone animate-on-scroll">
          <div class="drop-zone-border"></div>
          <div class="drop-icon">
            <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><polyline points="9 15 12 12 15 15"/>
            </svg>
          </div>
          <h3>Drop Transaction CSV Here</h3>
          <p>or <label for="fileInput" class="file-label">browse files</label></p>
          <input type="file" id="fileInput" accept=".csv" hidden />
          <div class="drop-hint">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
            Required: transaction_id, sender_id, receiver_id, amount, timestamp
          </div>
        </div>

        <!-- Schema Validation -->
        <div id="validationPanel" class="validation-panel hidden">
          <div class="validation-header">
            <h3>Schema Validation</h3>
            <div id="healthScore" class="health-score">
              <svg width="50" height="50" viewBox="0 0 36 36">
                <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#1e293b" stroke-width="3"/>
                <path id="healthRing" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#06d6a0" stroke-width="3" stroke-dasharray="0, 100" stroke-linecap="round"/>
              </svg>
              <span id="healthValue">0</span>
            </div>
          </div>
          <div id="validationResults" class="validation-results"></div>
        </div>

        <!-- Preview Table -->
        <div id="previewPanel" class="preview-panel hidden">
          <div class="preview-header">
            <h3>Data Preview</h3>
            <div class="preview-meta" id="previewMeta"></div>
          </div>
          <div class="table-wrapper">
            <table id="previewTable">
              <thead><tr id="previewHead"></tr></thead>
              <tbody id="previewBody"></tbody>
            </table>
          </div>
          <button id="analyzeBtn" class="btn-primary btn-glow">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10"/></svg>
            Analyze Transactions
          </button>
        </div>
      </div>
    </section>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <h3 id="loadingText">Analyzing transaction graph…</h3>
        <div class="loading-steps">
          <div class="loading-step active">Parsing CSV data</div>
          <div class="loading-step">Building transaction graph</div>
          <div class="loading-step">Detecting fraud patterns</div>
          <div class="loading-step">Scoring suspicion levels</div>
          <div class="loading-step">Computing graph layout</div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="dashboard-footer">
      <div class="footer-content">
        <span class="footer-brand">RIFT v1.0</span>
        <span class="footer-sep">·</span>
        <span>Fraud Intelligence Platform</span>
      </div>
    </footer>
  </div>

  <!-- ═══════════════════════════════════════════════════════════ -->
  <!--  VIEW 2: RESULTS PAGE                                     -->
  <!-- ═══════════════════════════════════════════════════════════ -->
  <div id="resultsView" class="view">

    <main id="mainContent">
      <!-- Risk Dashboard -->
      <div class="dashboard-grid">
        <div class="stat-card" id="statTotalAccounts">
          <div class="stat-icon blue">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          </div>
          <div class="stat-info">
            <span class="stat-value" data-target="0">0</span>
            <span class="stat-label">Total Accounts</span>
          </div>
        </div>
        <div class="stat-card" id="statSuspicious">
          <div class="stat-icon red">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
          </div>
          <div class="stat-info">
            <span class="stat-value" data-target="0">0</span>
            <span class="stat-label">Suspicious Accounts</span>
          </div>
        </div>
        <div class="stat-card" id="statRings">
          <div class="stat-icon orange">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
          </div>
          <div class="stat-info">
            <span class="stat-value" data-target="0">0</span>
            <span class="stat-label">Fraud Rings</span>
          </div>
        </div>
        <div class="stat-card" id="statProcessing">
          <div class="stat-icon green">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
          </div>
          <div class="stat-info">
            <span class="stat-value" data-target="0">0</span><span class="stat-unit">s</span>
            <span class="stat-label">Processing Time</span>
          </div>
        </div>
      </div>

      <!-- Insights Panel -->
      <div class="insights-panel" id="insightsPanel">
        <div class="insights-header">
          <h3>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/></svg>
            AI Insights
          </h3>
        </div>
        <div id="insightsList" class="insights-list"></div>
      </div>

      <!-- ═══ TAB BAR FOR MAIN PANELS ═══ -->
      <div class="tab-bar" id="tabBar">
        <button class="tab-btn active" data-tab="graph">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><line x1="6" y1="9" x2="6" y2="15"/><line x1="9" y1="6" x2="15" y2="6"/><line x1="9" y1="18" x2="15" y2="18"/><line x1="18" y1="9" x2="18" y2="15"/></svg>
          Graph
        </button>
        <button class="tab-btn" data-tab="rings">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="3" y1="15" x2="21" y2="15"/><line x1="9" y1="3" x2="9" y2="21"/></svg>
          Fraud Rings
        </button>
        <button class="tab-btn" data-tab="json">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
          JSON Output
        </button>
        <button class="tab-btn" data-tab="architecture">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
          Architecture
        </button>
      </div>

      <!-- ═══ GRAPH PANEL ═══ -->
      <div class="tab-panel active" id="graphPanel">
        <div class="graph-container">
          <!-- Graph Toolbar -->
          <div class="graph-toolbar">
            <div class="toolbar-group">
              <label class="toolbar-label">Filter</label>
              <select id="filterSelect" class="toolbar-select">
                <option value="all">All Nodes</option>
                <option value="suspicious">Suspicious Only</option>
              </select>
            </div>
            <div class="toolbar-group" id="ringFilterGroup">
              <label class="toolbar-label">Ring</label>
              <select id="ringFilter" class="toolbar-select">
                <option value="all">All Rings</option>
              </select>
            </div>
            <div class="toolbar-group investigator-only">
              <label class="toolbar-label">Pattern</label>
              <select id="patternMode" class="toolbar-select">
                <option value="default">Default</option>
                <option value="cycle">Cycles</option>
                <option value="fanout">Fan-in/out</option>
                <option value="shell">Shell Chains</option>
              </select>
            </div>
            <div class="toolbar-group investigator-only">
              <label class="toolbar-label">Amount ≥</label>
              <input type="number" id="amountFilter" class="toolbar-input" placeholder="0" min="0" />
            </div>
            <div class="toolbar-group">
              <button class="toolbar-btn" id="fitGraphBtn" title="Fit to view">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/></svg>
              </button>
              <button class="toolbar-btn" id="resetGraphBtn" title="Reset view">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
              </button>
            </div>
          </div>

          <!-- Time Travel Slider -->
          <div class="time-travel" id="timeTravelPanel">
            <div class="time-header">
              <h4>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                Time Travel
              </h4>
              <div class="time-controls">
                <button class="toolbar-btn" id="playBtn" title="Play">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21"/></svg>
                </button>
                <button class="toolbar-btn" id="resetTimeBtn" title="Reset">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
                </button>
              </div>
            </div>
            <input type="range" id="timeSlider" class="time-slider" min="0" max="100" value="100" />
            <div class="time-labels">
              <span id="timeStart">—</span>
              <span id="timeCurrent">All transactions</span>
              <span id="timeEnd">—</span>
            </div>
          </div>

          <!-- Graph Canvas -->
          <div id="cyGraph" class="cy-graph"></div>

          <!-- Legend -->
          <div class="graph-legend">
            <div class="legend-item"><span class="legend-dot" style="background:#06d6a0"></span> Clean</div>
            <div class="legend-item"><span class="legend-dot" style="background:#ffd166"></span> Low Risk</div>
            <div class="legend-item"><span class="legend-dot" style="background:#ef476f"></span> High Risk</div>
            <div class="legend-item"><span class="legend-dot ring-glow"></span> Ring Member</div>
          </div>
        </div>

        <!-- Account Deep-Dive Side Panel -->
        <div id="accountPanel" class="account-panel">
          <div class="account-panel-header">
            <h3 id="accountTitle">Account Details</h3>
            <button class="close-btn" id="closeAccountPanel">✕</button>
          </div>
          <div id="accountContent" class="account-content">
            <p class="hint-text">Click a node in the graph to view account details.</p>
          </div>
        </div>
      </div>

      <!-- ═══ FRAUD RINGS TABLE ═══ -->
      <div class="tab-panel" id="ringsPanel">
        <div class="rings-header">
          <h3>Fraud Ring Command Center</h3>
          <div class="rings-meta" id="ringsMeta"></div>
        </div>
        <div id="ringsLeaderboard" class="rings-leaderboard"></div>
        <div class="table-wrapper">
          <table id="ringsTable" class="rings-table">
            <thead>
              <tr>
                <th>Ring ID</th>
                <th>Pattern</th>
                <th>Members</th>
                <th>Risk Score</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="ringsBody"></tbody>
          </table>
        </div>
      </div>

      <!-- ═══ JSON OUTPUT ═══ -->
      <div class="tab-panel" id="jsonPanel">
        <div class="json-header">
          <h3>JSON Output Inspector</h3>
          <div class="json-controls">
            <label class="toggle-switch">
              <input type="checkbox" id="jsonHumanToggle" />
              <span class="toggle-slider"></span>
              <span class="toggle-label">Human-Readable</span>
            </label>
            <button class="btn-secondary" id="copyJsonBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              Copy
            </button>
            <button class="btn-primary" id="downloadJsonBtn">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              Download
            </button>
          </div>
        </div>
        <pre id="jsonViewer" class="json-viewer"><code>No analysis data yet. Upload a CSV to get started.</code></pre>
      </div>

      <!-- ═══ ARCHITECTURE VIEW ═══ -->
      <div class="tab-panel" id="architecturePanel">
        <div class="arch-container">
          <h3>System Architecture</h3>
          <div class="arch-grid">
            <div class="arch-card">
              <div class="arch-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#06d6a0" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
              </div>
              <h4>CSV Ingestion</h4>
              <p>Strict schema validation with column checks, UTF-8 encoding enforcement, timezone normalization, and a 10K transaction limit.</p>
            </div>
            <div class="arch-card">
              <div class="arch-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#00b4d8" stroke-width="2"><circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><circle cx="18" cy="18" r="3"/><line x1="9" y1="6" x2="15" y2="6"/><line x1="6" y1="9" x2="6" y2="15"/><line x1="18" y1="9" x2="18" y2="15"/><line x1="9" y1="18" x2="15" y2="18"/></svg>
              </div>
              <h4>Graph Construction</h4>
              <p>Directed graph built with adjacency + reverse-adjacency lists. Tracks per-node statistics: in/out degree, amounts, timestamps.</p>
            </div>
            <div class="arch-card">
              <div class="arch-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ef476f" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
              </div>
              <h4>Cycle Detection</h4>
              <p>Custom bounded DFS (depth 3–5) with 72-hour time constraint and ≤1.25 amount ratio. Canonical deduplication.</p>
            </div>
            <div class="arch-card">
              <div class="arch-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ffd166" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
              </div>
              <h4>Smurfing Detection</h4>
              <p>Fan-out pattern analysis: distributing funds to ≥5 recipients with similar amounts in short time windows.</p>
            </div>
            <div class="arch-card">
              <div class="arch-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#bb86fc" stroke-width="2"><path d="M4 4h16v16H4z"/><path d="M4 4l8 8m0 0l8-8m-8 8v8"/></svg>
              </div>
              <h4>Shell Chain Detection</h4>
              <p>Identifies layered pass-through chains with minimal retention, typical of laundering schemes.</p>
            </div>
            <div class="arch-card">
              <div class="arch-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#06d6a0" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
              </div>
              <h4>Scoring Engine</h4>
              <p>Multi-factor scoring: base pattern weights + interaction bonuses + structural confidence + density adjustment.</p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- ═══════════════ FALSE POSITIVE MODAL ═══════════════ -->
  <div id="fpModal" class="modal hidden">
    <div class="modal-content">
      <h3>Mark as Legitimate</h3>
      <p>Are you sure you want to mark <strong id="fpAccountId"></strong> as a legitimate account?</p>
      <p class="modal-hint">This will remove the suspicion flag and recalculate risk scores (client-side only).</p>
      <div class="modal-actions">
        <button class="btn-secondary" id="fpCancel">Cancel</button>
        <button class="btn-primary" id="fpConfirm">Confirm</button>
      </div>
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
